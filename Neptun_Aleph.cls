VERSION 2.0 CLASS
Private Sub CommandButton1_Click()
Dim i As Integer
Dim s As String
Dim stat As String, hol As String
Open "c:\Users\diszterhoft.zoltan\Desktop\shema.xml" For Output As #1
Write #1, "<p-file-20>"
For i = 2 To 485
If (ActiveWorkbook.Worksheets(1).Cells(i, 13) = "Állami ösztöndíjas") Then
stat = "A"
Else
stat = "K"
End If
Select Case ActiveWorkbook.Worksheets(1).Cells(i, 15)
Case "Pedagógiai Kar"
      hol = "63"
Case "Rippl-Rónai Művészeti Kar"
      hol = "59"
Case "Agrár- és Környezettudományi Kar"
      hol = "51"
Case "Gazdálkodás- és szervezéstudományok"
      hol = "57"
Case "Gazdaságtudományi Kar"
      hol = "55"
End Select
s = stat + "$" + ActiveWorkbook.Worksheets(1).Cells(i, 11) + "$" + ActiveWorkbook.Worksheets(1).Cells(i, 12)
Write #1, "<patron-record>"
Write #1, "<z303>"
Write #1, "<match-id-type>00</match-id-type>"
Write #1, "<match-id>" + ActiveWorkbook.Worksheets(1).Cells(i, 2) + "</match-id>"
Write #1, "<record-action>A</record-action>"
Write #1, "<z303-id>" + ActiveWorkbook.Worksheets(1).Cells(i, 2) + "</z303-id>"
Write #1, "<z303-user-type>REG</z303-user-type>"
Write #1, "<z303-con-lng>HUN</z303-con-lng>"
Write #1, "<z303-name>" & ActiveWorkbook.Worksheets(1).Cells(i, 1) & "</z303-name>"
Write #1, "<z303-title></z303-title>"
Write #1, "<z303-delinq-1>00</z303-delinq-1>"
Write #1, "<z303-delinq-n-1></z303-delinq-n-1>"
Write #1, "<z303-delinq-3>00</z303-delinq-3>"
Write #1, "<z303-delinq-n-3></z303-delinq-n-3>"
Write #1, "<z303-budget></z303-budget>"
Write #1, "<z303-profile-id></z303-profile-id>"
Write #1, "<z303-ill-library></z303-ill-library>"
Write #1, "<z303-home-library></z303-home-library>"
Write #1, "<z303-note-1></z303-note-1>"
Write #1, "<z303-ill-total-limit>0000</z303-ill-total-limit>"
Write #1, "<z303-ill-active-limit>0000</z303-ill-active-limit>"
Write #1, "<z303-birth-date>" & ActiveWorkbook.Worksheets(1).Cells(i, 5) & "</z303-birth-date>"
Write #1, "<z303-export-consent>N</z303-export-consent>"
Write #1, "<z303-proxy-id-type>00</z303-proxy-id-type>"
Write #1, "<z303-send-all-letters>Y</z303-send-all-letters>"
Write #1, "<z303-plain-html>H</z303-plain-html>"
 Write #1, "<z303-want-sms>N</z303-want-sms>"
 Write #1, "<z303-title-req-limit>0000</z303-title-req-limit>"
Write #1, "<z303-gender></z303-gender>"
Write #1, "<z303-birthplace>" + ActiveWorkbook.Worksheets(1).Cells(i, 4) + "</z303-birthplace>"
Write #1, "</z303>"
Write #1, "<z304>"
Write #1, "<record-action>A</record-action>"
Write #1, "<z304-id>" + ActiveWorkbook.Worksheets(1).Cells(i, 2) + "</z304-id>"
Write #1, "<z304-sequence>01</z304-sequence>"
Write #1, "<z304-address-0>" + ActiveWorkbook.Worksheets(1).Cells(i, 1) + "</z304-address-0>"
Write #1, "<z304-address-1>" & ActiveWorkbook.Worksheets(1).Cells(i, 7) & "</z304-address-1>"
Write #1, "<z304-address-2>" + ActiveWorkbook.Worksheets(1).Cells(i, 8) + "</z304-address-2>"
Write #1, "<z304-address-3></z304-address-3>"
Write #1, "<z304-address-4></z304-address-4>"
 Write #1, "<z304-zip>" & ActiveWorkbook.Worksheets(1).Cells(i, 6) & "</z304-zip>"
Write #1, "<z304-email-address>" + ActiveWorkbook.Worksheets(1).Cells(i, 9) + "</z304-email-address>"
Write #1, "<z304-telephone>" + ActiveWorkbook.Worksheets(1).Cells(i, 10) + "</z304-telephone>"
Write #1, "<z304-date-from>20170901</z304-date-from>"
Write #1, "<z304-date-to>21120130</z304-date-to>"
Write #1, "<z304-address-type>02</z304-address-type>"
Write #1, "</z304>"
Write #1, "<z305>"
Write #1, "<record-action>A</record-action>"
Write #1, "<z305-id>" + ActiveWorkbook.Worksheets(1).Cells(i, 2) + "</z305-id>"
Write #1, "<z305-sub-library>PAK50</z305-sub-library>"
Write #1, "<z305-bor-type></z305-bor-type>"
Write #1, "<z305-bor-status>" + hol + "</z305-bor-status>"
Write #1, "<z305-registration-date>20170901</z305-registration-date>"
Write #1, "<z305-expiry-date>20170907</z305-expiry-date>"
Write #1, "<z305-note></z305-note>"
Write #1, "<z305-delinq-1>01</z305-delinq-1>"
Write #1, "<z305-delinq-n-1></z305-delinq-n-1>"
Write #1, "<z305-field-1>" + s + "</z305-field-1>"
Write #1, "<z305-field-2>Aktív</z305-field-2>"
Write #1, "</z305>"
Write #1, "<z308>"
Write #1, "<record-action>A</record-action>"
Write #1, "<z308-key-type>00</z308-key-type>"
Write #1, "<z308-key-data>" + ActiveWorkbook.Worksheets(1).Cells(i, 2) + "</z308-key-data>"
Write #1, "<z308-verification>" + ActiveWorkbook.Worksheets(1).Cells(i, 2) + "</z308-verification>"
Write #1, "<z308-verification-type>01</z308-verification-type>"
Write #1, "<z308-status>AC</z308-status>"
Write #1, "<z308-encryption>H</z308-encryption>"
Write #1, "</z308>"
Write #1, "<z308>"
Write #1, "<record-action>A</record-action>"
Write #1, "<z308-key-type>01</z308-key-type>"
Write #1, "<z308-key-data>" + ActiveWorkbook.Worksheets(1).Cells(i, 2) + "</z308-key-data>"
Write #1, "<z308-verification>" + ActiveWorkbook.Worksheets(1).Cells(i, 2) + "</z308-verification>"
Write #1, "<z308-verification-type>01</z308-verification-type>"
Write #1, "<z308-status>AC</z308-status>"
Write #1, "<z308-encryption>H</z308-encryption>"
Write #1, "</z308>"
Write #1, "<z308>"
Write #1, "<record-action>A</record-action>"
Write #1, "<z308-key-type>02</z308-key-type>"
Write #1, "<z308-key-data>" + ActiveWorkbook.Worksheets(1).Cells(i, 2) + "</z308-key-data>"
Write #1, "<z308-verification>" + ActiveWorkbook.Worksheets(1).Cells(i, 2) + "</z308-verification>"
Write #1, "<z308-verification-type>01</z308-verification-type>"
Write #1, "<z308-status>AC</z308-status>"
Write #1, "<z308-encryption>H</z308-encryption>"
Write #1, "</z308>"
Write #1, "</patron-record>"


Write #1, "<patron-record>"
Write #1, "<z303>"
Write #1, "<match-id-type>00</match-id-type>"
Write #1, "<match-id>" + ActiveWorkbook.Worksheets(1).Cells(i, 2) + "</match-id>"
Write #1, "<record-action>I</record-action>"
Write #1, "<z303-id>" + ActiveWorkbook.Worksheets(1).Cells(i, 2) + "</z303-id>"
Write #1, "<z303-user-type>REG</z303-user-type>"
Write #1, "<z303-con-lng>HUN</z303-con-lng>"
Write #1, "<z303-name>" & ActiveWorkbook.Worksheets(1).Cells(i, 1) & "</z303-name>"
Write #1, "<z303-title></z303-title>"
Write #1, "<z303-delinq-1>00</z303-delinq-1>"
Write #1, "<z303-delinq-n-1></z303-delinq-n-1>"
Write #1, "<z303-delinq-3>00</z303-delinq-3>"
Write #1, "<z303-delinq-n-3></z303-delinq-n-3>"
Write #1, "<z303-budget></z303-budget>"
Write #1, "<z303-profile-id></z303-profile-id>"
Write #1, "<z303-ill-library></z303-ill-library>"
Write #1, "<z303-home-library></z303-home-library>"
Write #1, "<z303-note-1></z303-note-1>"
Write #1, "<z303-ill-total-limit>0000</z303-ill-total-limit>"
Write #1, "<z303-ill-active-limit>0000</z303-ill-active-limit>"
Write #1, "<z303-birth-date>" & ActiveWorkbook.Worksheets(1).Cells(i, 5) & "</z303-birth-date>"
Write #1, "<z303-export-consent>N</z303-export-consent>"
Write #1, "<z303-proxy-id-type>00</z303-proxy-id-type>"
Write #1, "<z303-send-all-letters>Y</z303-send-all-letters>"
Write #1, "<z303-plain-html>H</z303-plain-html>"
 Write #1, "<z303-want-sms>N</z303-want-sms>"
 Write #1, "<z303-title-req-limit>0000</z303-title-req-limit>"
Write #1, "<z303-gender></z303-gender>"
Write #1, "<z303-birthplace>" + ActiveWorkbook.Worksheets(1).Cells(i, 4) + "</z303-birthplace>"
Write #1, "</z303>"
Write #1, "<z304>"
Write #1, "<record-action>I</record-action>"
Write #1, "<z304-id>" + ActiveWorkbook.Worksheets(1).Cells(i, 2) + "</z304-id>"
Write #1, "<z304-sequence>01</z304-sequence>"
Write #1, "<z304-address-0>" + ActiveWorkbook.Worksheets(1).Cells(i, 1) + "</z304-address-0>"
Write #1, "<z304-address-1>" & ActiveWorkbook.Worksheets(1).Cells(i, 7) & "</z304-address-1>"
Write #1, "<z304-address-2>" + ActiveWorkbook.Worksheets(1).Cells(i, 8) + "</z304-address-2>"
Write #1, "<z304-address-3></z304-address-3>"
Write #1, "<z304-address-4></z304-address-4>"
 Write #1, "<z304-zip>" & ActiveWorkbook.Worksheets(1).Cells(i, 6) & "</z304-zip>"
Write #1, "<z304-email-address>" + ActiveWorkbook.Worksheets(1).Cells(i, 9) + "</z304-email-address>"
Write #1, "<z304-telephone>" + ActiveWorkbook.Worksheets(1).Cells(i, 10) + "</z304-telephone>"
Write #1, "<z304-date-from>20170701</z304-date-from>"
Write #1, "<z304-date-to>21120130</z304-date-to>"
Write #1, "<z304-address-type>02</z304-address-type>"
Write #1, "</z304>"
Write #1, "<z305>"
Write #1, "<record-action>I</record-action>"
Write #1, "<z305-id>" + ActiveWorkbook.Worksheets(1).Cells(i, 2) + "</z305-id>"
Write #1, "<z305-sub-library>PAK50</z305-sub-library>"
Write #1, "<z305-bor-type></z305-bor-type>"
Write #1, "<z305-bor-status>" + hol + "</z305-bor-status>"
Write #1, "<z305-registration-date>20170901</z305-registration-date>"
Write #1, "<z305-expiry-date>20170907</z305-expiry-date>"
Write #1, "<z305-note></z305-note>"
Write #1, "<z305-delinq-1>01</z305-delinq-1>"
Write #1, "<z305-delinq-n-1></z305-delinq-n-1>"
Write #1, "<z305-field-1>" + s + "</z305-field-1>"
Write #1, "<z305-field-2>Aktív</z305-field-2>"
Write #1, "</z305>"
Write #1, "<z308>"
Write #1, "<record-action>I</record-action>"
Write #1, "<z308-key-type>00</z308-key-type>"
Write #1, "<z308-key-data>" + ActiveWorkbook.Worksheets(1).Cells(i, 2) + "</z308-key-data>"
Write #1, "<z308-verification>" + ActiveWorkbook.Worksheets(1).Cells(i, 2) + "</z308-verification>"
Write #1, "<z308-verification-type>01</z308-verification-type>"
Write #1, "<z308-status>AC</z308-status>"
Write #1, "<z308-encryption>H</z308-encryption>"
Write #1, "</z308>"
Write #1, "<z308>"
Write #1, "<record-action>I</record-action>"
Write #1, "<z308-key-type>01</z308-key-type>"
Write #1, "<z308-key-data>" + ActiveWorkbook.Worksheets(1).Cells(i, 2) + "</z308-key-data>"
Write #1, "<z308-verification>" + ActiveWorkbook.Worksheets(1).Cells(i, 2) + "</z308-verification>"
Write #1, "<z308-verification-type>01</z308-verification-type>"
Write #1, "<z308-status>AC</z308-status>"
Write #1, "<z308-encryption>H</z308-encryption>"
Write #1, "</z308>"
Write #1, "<z308>"
Write #1, "<record-action>I</record-action>"
Write #1, "<z308-key-type>02</z308-key-type>"
Write #1, "<z308-key-data>" + ActiveWorkbook.Worksheets(1).Cells(i, 2) + "</z308-key-data>"
Write #1, "<z308-verification>" + ActiveWorkbook.Worksheets(1).Cells(i, 2) + "</z308-verification>"
Write #1, "<z308-verification-type>01</z308-verification-type>"
Write #1, "<z308-status>AC</z308-status>"
Write #1, "<z308-encryption>H</z308-encryption>"
Write #1, "</z308>"
Write #1, "</patron-record>"
 Next i
Write #1, "</p-file-20>"
Close #1
End Sub








